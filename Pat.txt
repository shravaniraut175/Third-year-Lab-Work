CREATE TABLE Time_Dim (
    Time_ID INT PRIMARY KEY,
    Day INT,
    Month VARCHAR(15),
    Quarter VARCHAR(10),
    Year INT
);
CREATE TABLE Doctor_Dim (
    Doctor_ID INT PRIMARY KEY,
    Doctor_Name VARCHAR(50),
    Specialization VARCHAR(50),
    Hospital_Name VARCHAR(50)
);
CREATE TABLE Patient_Dim (
    Patient_ID INT PRIMARY KEY,
    Patient_Name VARCHAR(50),
    Gender VARCHAR(10),
    Age INT
);
CREATE TABLE Visit_Fact (
    Visit_ID INT PRIMARY KEY,
    Time_ID INT,
    Doctor_ID INT,
    Patient_ID INT,
    Visit_Count INT,
    Charge DECIMAL(10,2),
    FOREIGN KEY (Time_ID) REFERENCES Time_Dim(Time_ID),
    FOREIGN KEY (Doctor_ID) REFERENCES Doctor_Dim(Doctor_ID),
    FOREIGN KEY (Patient_ID) REFERENCES Patient_Dim(Patient_ID)
);


-- Time Dimension

INSERT INTO Time_Dim VALUES
(1, 5, 'January', 'Q1', 2025),
(2, 15, 'February', 'Q1', 2025),
(3, 10, 'March', 'Q1', 2025);


-- Doctor Dimension
INSERT INTO Doctor_Dim VALUES
(1, 'Dr. Sharma', 'Cardiology', 'City Hospital'),
(2, 'Dr. Iyer', 'Dermatology', 'Metro Hospital'),
(3, 'Dr. Patel', 'Orthopedics', 'Care Clinic');


-- Patient Dimension
INSERT INTO Patient_Dim VALUES
(1, 'Rohit', 'Male', 28),
(2, 'Priya', 'Female', 32),
(3, 'Ananya', 'Female', 40);


-- Fact Table (Visits)
INSERT INTO Visit_Fact VALUES
(1, 1, 1, 1, 1, 1000.00),
(2, 2, 2, 2, 1, 800.00),
(3, 3, 1, 3, 2, 2000.00),
(4, 1, 3, 2, 1, 1200.00);

SELECT * FROM Time_Dim;S
ELECT * FROM Doctor_Dim;
SELECT * FROM Patient_Dim;
SELECT * FROM Visit_Fact;


1️⃣ Roll-up Operation
SELECT 
    d.Doctor_Name,
    d.Specialization,
    SUM(v.Charge) AS Total_Charges,
    SUM(v.Visit_Count) AS Total_VisitsFROM Visit_Fact vJOIN Doctor_Dim d ON v.Doctor_ID = d.Doctor_IDGROUP BY d.Doctor_Name, d.Specialization;

2️⃣ Drill-down Operation
SELECT 
    d.Doctor_Name,
    p.Patient_Name,
    v.Visit_Count,
    v.Charge,
    t.Month,
    t.YearFROM Visit_Fact vJOIN Doctor_Dim d ON v.Doctor_ID = d.Doctor_IDJOIN Patient_Dim p ON v.Patient_ID = p.Patient_IDJOIN Time_Dim t ON v.Time_ID = t.Time_IDORDER BY d.Doctor_Name, p.Patient_Name;


1️⃣ Slice Operation
SELECT 
    d.Doctor_Name,
    p.Patient_Name,
    v.Visit_Count,
    v.ChargeFROM Visit_Fact vJOIN Doctor_Dim d ON v.Doctor_ID = d.Doctor_IDJOIN Patient_Dim p ON v.Patient_ID = p.Patient_IDJOIN Time_Dim t ON v.Time_ID = t.Time_IDWHERE t.Month = 'January' AND t.Year = 2025;


2️⃣ Dice Operation
SELECT 
    d.Doctor_Name,
    p.Patient_Name,
    p.Gender,
    t.Month,
    v.Visit_Count,
    v.ChargeFROM Visit_Fact vJOIN Doctor_Dim d ON v.Doctor_ID = d.Doctor_IDJOIN Patient_Dim p ON v.Patient_ID = p.Patient_IDJOIN Time_Dim t ON v.Time_ID = t.Time_IDWHERE d.Specialization = 'Cardiology'
  AND p.Gender = 'Female'
  AND t.Quarter = 'Q1'
  AND t.Year = 2025;
