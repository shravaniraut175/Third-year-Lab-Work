CREATE TABLE Course_Section_Dim (
    Course_ID INT PRIMARY KEY,
    Course_Name VARCHAR(50),
    Section VARCHAR(10),
    Credits INT
);
CREATE TABLE Professor_Dim (
    Professor_ID INT PRIMARY KEY,
    Professor_Name VARCHAR(50),
    Department VARCHAR(50)
);
CREATE TABLE Student_Dim (
    Student_ID INT PRIMARY KEY,
    Student_Name VARCHAR(50),
    Major VARCHAR(50),
    Year INT
);
CREATE TABLE Period_Dim (
    Period_ID INT PRIMARY KEY,
    Semester VARCHAR(10),
    Academic_Year VARCHAR(10)
);
CREATE TABLE Grade_Fact (
    Grade_ID INT PRIMARY KEY,
    Course_ID INT,
    Professor_ID INT,
    Student_ID INT,
    Period_ID INT,
    Course_Grade CHAR(2),
    FOREIGN KEY (Course_ID) REFERENCES Course_Section_Dim(Course_ID),
    FOREIGN KEY (Professor_ID) REFERENCES Professor_Dim(Professor_ID),
    FOREIGN KEY (Student_ID) REFERENCES Student_Dim(Student_ID),
    FOREIGN KEY (Period_ID) REFERENCES Period_Dim(Period_ID)
);


-- Course Section Dimension
INSERT INTO Course_Section_Dim VALUES
(1, 'Database Systems', 'A', 4),
(2, 'Computer Networks', 'B', 3),
(3, 'Data Mining', 'A', 3);


-- Professor Dimension
INSERT INTO Professor_Dim VALUES
(1, 'Dr. Sharma', 'Computer Science'),
(2, 'Dr. Iyer', 'Information Technology');


-- Student Dimension
INSERT INTO Student_Dim VALUES
(1, 'Shravani', 'IT', 3),
(2, 'Rohit', 'CS', 3),
(3, 'Priya', 'IT', 2);


-- Period Dimension
INSERT INTO Period_Dim VALUES
(1, 'Sem V', '2025-26'),
(2, 'Sem VI', '2025-26');


-- Fact Table
INSERT INTO Grade_Fact VALUES
(1, 1, 1, 1, 1, 'A'),
(2, 2, 2, 2, 1, 'B'),
(3, 3, 1, 3, 2, 'A');


SELECT * FROM Course_Section_Dim;
SELECT * FROM Professor_Dim;
SELECT * FROM Student_Dim;
SELECT * FROM Period_Dim;
SELECT * FROM Grade_Fact;


1️⃣ Roll-up Operation
SELECT 
    c.Course_Name,
    COUNT(g.Course_Grade) AS Total_Students,
    AVG(CASE 
            WHEN g.Course_Grade = 'A' THEN 4
            WHEN g.Course_Grade = 'B' THEN 3
            WHEN g.Course_Grade = 'C' THEN 2
            ELSE 0
        END) AS Avg_Grade_ScoreFROM Grade_Fact gJOIN Course_Section_Dim c ON g.Course_ID = c.Course_IDGROUP BY c.Course_Name;

2️⃣ Drill-down Operation
SELECT 
    c.Course_Name,
    s.Student_Name,
    g.Course_GradeFROM Grade_Fact gJOIN Course_Section_Dim c ON g.Course_ID = c.Course_IDJOIN Student_Dim s ON g.Student_ID = s.Student_IDORDER BY c.Course_Name, s.Student_Name;


1️⃣ Slice Operation
SELECT 
    s.Student_Name,
    c.Course_Name,
    g.Course_GradeFROM Grade_Fact gJOIN Student_Dim s ON g.Student_ID = s.Student_IDJOIN Course_Section_Dim c ON g.Course_ID = c.Course_IDJOIN Period_Dim p ON g.Period_ID = p.Period_IDWHERE p.Semester = 'Sem V' AND p.Academic_Year = '2025-26';

2️⃣ Dice Operation
SELECT 
    s.Student_Name,
    c.Course_Name,
    p.Semester,
    pr.Professor_Name,
    g.Course_GradeFROM Grade_Fact gJOIN Student_Dim s ON g.Student_ID = s.Student_IDJOIN Course_Section_Dim c ON g.Course_ID = c.Course_IDJOIN Professor_Dim pr ON g.Professor_ID = pr.Professor_IDJOIN Period_Dim p ON g.Period_ID = p.Period_IDWHERE s.Major = 'IT'
  AND pr.Professor_Name = 'Dr. Sharma'
  AND p.Semester = 'Sem V';
